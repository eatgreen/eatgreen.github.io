nemevar est un system de assimilation de donnee pour le modele ocean nemo. il est essentialment un system variationelle. effectivement, juste un seul minimizaion s'effectue. bien que on peut utilizer les combination different de B, static B et ensemble B, on peut aussi utilizer les ensemble pour costruie le static B. Generallement, le problem se pose comme ca, on a un ensemble backgound, et apres assimilation, on voudrais avoir un analysis ensemble puisque on pourrias faire ensemble previons, ce genre de choses. Mais on ne veut pas ajouter l'autre systeme comme enkf, si on fais ca, il faut que nous coupler les deux systeme. ou eda qui cout cher. donc l'idea centrale est de generer d'ensemble poteriror/analysis en utilisant que les info de systeme variationnel. qui assure egalement le coherence entre le ensemble analusis et l'etat analysis.

donc comment faire ca, on se repose sur le lien entre pa et hessian, pa egale inverse hessian. on a besoin d'un approxiamtion de hessian a partir de ritz paris. a part ca, faut mentionner, on s'interresse a des transformation left, c'est a dire a espace etat au lieu que espace ensemble qui n'est pas compatible avec localization par schur product.

nemovar peut idealement tester ce schemea parce que nemovat utilize cg, a cause du lien entre cg et lanczos, ce qui nous permet de estimer les valeurs propores extreme de matrix hessian.

dans nemovar, on a 2 types de scheme minimization, le 1er BPCG, preconditionné par B, l'autre RBPCG, dans espace observation. on a un hessian different qui partage la meme valeur propore. Pendant minimization, on produit les vectrues lanciza qui en effect egale le residual normalise. En utilisant lanczos, le hessian peur se tridiagooszeee. et Tk est de taille tres faible, on peur calculer son eigen spectre directment. 

comme zk hat et zk bar sone orthnormal, donc le norm de matrix qui depend directlment des valeus ritz, visibilemt des valeus extreme propre. generallent, dans un cadre de operationnel, on a un hessian qui a non-un eigen values dont le nombre est pas plus que le nombre de observation. donc theorruqement, on dois effectuer le nombre de iteration egale le nombre de obs, mais c'est pas possible non plus. Donc finament le faisebility de devil se repose sur le problem de convergence, combine de iteration est suffisant pour ce system afin de extraire des assez ritz paris. 

C'est pour ca on a etudier plusieur choses ici, d'abord, le somme de valeurs ritz est importants, dans ce cas la, pas bon parce que le somme augment linear. dans l'autre cas, ou on utilize un correlation plus long, un variance plus faible. le convergece s'amoliore a cause de le changement de forme de spectre de hessian. toujours dans certain cas de bens, car on utilize un length scale plus cours, ce coubre se baisse, le convergece est pas mal aussi. Mais le problem se pose c'est que dans realité, on doit fixer le B prenon en compte l'eutre constraint ,perspective, , en fait c'est l'inverse. il y  s une chose qui m'interres c'est que avec le static B sans ensemble info, le convergence n'est pas bon, mais en terms de norm de perturbation, ca a l'air de converger, au moins, ca augment. mais en terms de variance, on espere un reduction de variance analysis, normallent, le norm de matrix hessian est moins un, mais il n'y pas de reduction.

nemovar is a variational data assimilation system for nemo ocean model. so it is essentially a varitonal system, only one minimization is performed. although we can use different combination of B matrix, either model part, static with climatilogy information, or using ensemble information. Generally we are in possesion of the ensemble, here is the background ensemble, after assimilation, we want to have an analysis ensemble so that we can do other stuff, like ensemble previson. but we do not want to add another system like enkf, it is like doing two systems of assimilation by coupling the information. Or EDA which costs expensive in temrs of computation. The idea is to generate the analysis ensemble by only using the information from the variational system, which also assures the consistency between the analysis ensemble and the analysis state.

how we do that, we rely on the link between the pa an hessian. genarally we have pa equals inverse hessian. we will need an approximation to this hessian by its ritz paris. ritz pairs are esseteeilly the approximation of eigen pairs. we are interested in doing left transformation other than right, because right transformation is done in ensemble space not compatible with the localization scheme. 

nemovar can idealy test this scheme since nemovar use cg, because of the similarity between cg and lanczos, we can evaluate the extreme eigen paris without too much extra effort.  

in nemovar, we have two kinds of minimization schemes. the first is BPCG, precondioned by B, the other RBPCG, we solve the dual problem in observation space. in BPCG, we have a different hessian whose eigen paris are related to the previous eigen paris. during minimization, we produce the lancoz vectors, the normalized residual, we can use them to tridiagonalize the hessian. so Tk is of size k by k, very small, whose eigen pairs can be computed easily. 

since zk hat and zk bar are orthnormal, so the norm of the matrix which diretly related to the maginitude of the analysis ensemble is determind by the ritz values. usually the number of the non-one eigen values are no more than the number of observations, it is impractical to do that. so the problem is how many iteration do we need to extract enough ritz paris. to see this, we evlauate the perturbation, the average variance and the sum of Ritz values in terms of iteration. ans we use different B.

The sum of ritz values are important. in some case, it is almost linearly growing, so not good. in other cases where we use correlation matrix with a much longer length scale, the conditional number of the hessian increases, which is bad for the minimization. but the convergence of hessian is good. still in Bens cases, where we use shorter length scale for lozalization matrix, the convergence is better with low conditional number. but generally we did not choose the B formulation upon the convergence of devil, but rather inverse, we fix the B formulation and we want to see if it work or not. The interesting thing is with a static B, no ensemble information is used, the variance is not decreasing, which means even we are assimilating observations, the ensemble analysis variance is not reduced. 